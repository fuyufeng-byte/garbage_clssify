# garbage_clssify
# 垃圾分类介绍


* 应用Tensorflow完成垃圾分类数据的读取以及处理要求

## 垃圾分类介绍
* 垃圾分类问题是2019年的社会热点问题，2019年6月25日，生活垃圾分类制度将入法。上海成为第一个中国垃圾分类试点城市。
* 一般是指按一定规定或标准将垃圾分类储存、分类投放和分类搬运，从而转变成公共资源的一系列活动的总称。分类的目的是提高垃圾的资源价值和经济价值，力争物尽其用。1、垃圾分类问题的需求 ：

## 小猪佩奇版本：

* 注：湿垃圾（厨余垃圾），干垃圾（其他垃圾）
分类知识小拓展：可回收物指适宜回收和资源利用的废弃物，包括废弃的玻璃、金属、塑料、纸类、织物、家具、电器电子产品和年花年桔等。厨余垃圾指家庭、个人产生的易腐性垃圾，包括剩菜、剩饭、菜叶、果皮、蛋壳、茶渣、汤渣、骨头、废弃食物以及厨房下脚料等。有害垃圾指对人体健康或者自然环境造成直接或者潜在危害且应当专门处理的废弃物，包括废电池、废荧光灯管等。其他垃圾指除以上三类垃圾之外的其他生活垃圾，比如纸尿裤、尘土、烟头、一次性快餐盒、破损花盆及碗碟、墙纸等。
## 1、垃圾分类意义

* 减少占地、减少污染、变废为宝

## 3、垃圾分类难点

* 种类多，易分错：如口香糖？湿纸巾？瓜子皮？塑料袋？

* 干，干，湿，可回收
* 自动分捡

## 人们通过手机拍照，用程序自动识别出垃圾的类别，不仅简化人们对垃圾分类的处理，而且提高垃圾分类的准确性。

## 垃圾分类比赛

##  1、华为云人工智能大赛·垃圾分类挑战杯
		* 
官网：https://competition.huaweicloud.com/information/1000007620/introduction


* 1、垃圾种类40类

{
"0": "其他垃圾/一次性快餐盒",
"1": "其他垃圾/污损塑料",
"2": "其他垃圾/烟蒂",
"3": "其他垃圾/牙签",
"4": "其他垃圾/破碎花盆及碟碗",
"5": "其他垃圾/竹筷",
"6": "厨余垃圾/剩饭剩菜",
"7": "厨余垃圾/大骨头",
"8": "厨余垃圾/水果果皮",
"9": "厨余垃圾/水果果肉",
"10": "厨余垃圾/茶叶渣",
"11": "厨余垃圾/菜叶菜根",
"12": "厨余垃圾/蛋壳",
"13": "厨余垃圾/鱼骨",
"14": "可回收物/充电宝",
"15": "可回收物/包",
"16": "可回收物/化妆品瓶",
"17": "可回收物/塑料玩具",
"18": "可回收物/塑料碗盆",
"19": "可回收物/塑料衣架",
"20": "可回收物/快递纸袋",
"21": "可回收物/插头电线",
"22": "可回收物/旧衣服",
"23": "可回收物/易拉罐",
"24": "可回收物/枕头",
"25": "可回收物/毛绒玩具",
"26": "可回收物/洗发水瓶",
"27": "可回收物/玻璃杯",
"28": "可回收物/皮鞋",
"29": "可回收物/砧板",
"30": "可回收物/纸板箱",
"31": "可回收物/调料瓶",
"32": "可回收物/酒瓶",
"33": "可回收物/金属食品罐",
"34": "可回收物/锅",
"35": "可回收物/食用油桶",
"36": "可回收物/饮料瓶",
"37": "有害垃圾/干电池",
"38": "有害垃圾/软膏",
"39": "有害垃圾/过期药物"
}

## 2、其他比赛

* Apache Flink极客挑战赛——垃圾图片分类


* 官方：https://tianchi.aliyun.com/competition/entrance/231743/information

## 华为垃圾分类比赛介绍
* 本次比赛选取40种生活中常见的垃圾，选手根据公布的数据集进行模型训练，将训练好的模型发布到华为ModelArts平台上，在线预测华为的私有数据集，采用识别准确率作为评价指标。这次比赛中有很多容易混淆的类，比如饮料瓶和调料瓶、筷子和牙签、果皮和果肉等外形极为相似的垃圾，因此此次竞赛也可看作是细粒度图像分类任务。重要：比赛或者项目解题思路

* 1、拿到数据后，首先做数据分析。统计数据样本分布，尺寸分布，图片形态等，基于分析可以做一些针对性的数据预处理算法，对后期的模型训练会有很大的帮助

* 2、选择好的baseline。需要不断的尝试各种现有的网络结构，进行结果对比，挑选出适合该网络的模型结构，然后基于该模型进行不断的调参，调试出性能较好的参数

* 3、做结果验证，将上述模型在验证集上做结果验证，找出错误样本，分析出错原因，然后针对性的调整网络和数据。

## 3、基于新数据和模型，再次进行模型调优

* 比赛表现前5团队效果
名次
准确率
推理(inference)时间(ms)
第一名
0.969636
102.8
第二名
0.96251
95.43
第三名
0.962045
97.25
第四名
0.961735
82.99
第五名
0.957397
108.494.9.2.1 赛题分析1、问题描述:
经典图像分类问题。采用深圳市垃圾分类标准，输出该物品属于可回收物、 厨余垃圾、有害垃圾和其他垃圾中的二级分类，共43个类别。2、评价指标:
识别准确率 = 识别正确的图片数 / 图片总数3、挑战:

* 官方训练集有19459张图片，数据量小;

* 类别较多(40)，且各类样本不平衡;

* 图片大小、分辨率不一，垃圾物品有多种尺度;

* 垃圾分类是细粒度、粗粒度兼有的一种分类问题，轮廓、纹理、对象位置分 布都需要考察

## 对策

* 1、数据集分析和选择

* 2、模型选择
	
* 3、图像分类问题常见trick（优化）

## 1、数据集情况
* 数据集下载以及组成


* 组成有train_data，然后同目录下有图片以及对应txt

* txt中的格式：img_1.jpg, 0-为图片以及对应目标
	
* 注：官方还有V2版本的数据，拓展了类别共43类（我们后面的项目是在第一个版本的数据中做训练）

## 2、分类模型选择
* 数据量小、类别多、推理时间短->综合考察计 算量、体积、精度，选择近期才发布的高质量 预训练模型(EfficientNet B5/B4)进行迁移 学习（1）现有模型以及准确率对比
* Top-1 准确率和 Top-5 准确率都是在 ImageNet 验证集上的结果。



Architecture
@top1*
@top5*
Weights
EfficientNetB0
0.7668
0.9312
+
EfficientNetB1
0.7863
0.9418
+
EfficientNetB2
0.7968
0.9475
+
EfficientNetB3
0.8083
0.9531
+
Tensorflow在 ImageNet 上预训练过的用于图像分类的模型（TFAPI文档，官网会推荐安装）：



# 输入大小
EfficientNetB0 - (224, 224, 3)
EfficientNetB1 - (240, 240, 3)
EfficientNetB2 - (260, 260, 3)
EfficientNetB3 - (300, 300, 3)
EfficientNetB4 - (380, 380, 3)
EfficientNetB5 - (456, 456, 3)
EfficientNetB6 - (528, 528, 3)
EfficientNetB7 - (600, 600, 3)
注：项目降到模型部分会详细介绍模型3、 图像分类问题常见trick（优化）（1）数据方面

* 分析：下图横坐标是类标号，纵坐标是每个类的样本数量。

* 很容易看出，每个类之间的样本量差异很大，如果不做类均衡处理，很有可能会导致样本量多的类过拟合，样本量少的类欠拟合。

* 常见的类均衡方法有：多数类欠采样，少数类过采样；数据增强；标签平滑；

* 图片长宽比有一定的差异性，长宽比大多数集中于1，因此也适合一些模型输入尺寸设为1：1

## 1、数据增强

		
* （1）并非所有数据增强方法都有效，要保证数据增强后目标仍可肉眼分辨，且不改变图像所属类别。
		
* （2）过多的数据增强也会延长模型训练时间，通常翻转的效果不错（随机水平翻转、随机垂直翻转、以一定概率随机旋转90°、180°、270°、随机crop(0-10%)等）
		
其他如下：
		
* Color Jittering:对颜色的数据增强:图像亮度、饱和度、对比度变化
		
* Random Scale:尺度变换;
		
* Random Crop:采用随机图像差值方式，对图像进行裁剪、缩放
		
* Horizontal/Vertical Flip:水平/垂直翻转;
		
* Shift:平移变换;
		
* Rotation/Reflection:旋转/仿射变换;
		
* Noise:高斯噪声、模糊处理;
	
* 2、外部数据：比赛不限制使用外部数据，也就是说可以通过自己拍照、网上爬取等方式获得更多的训练数据，但比较费时耗力。通常自己找的数据集质量也不够好，与华为公布的数据集分布不同，有些团队爬取一些额外数据，最终效果都不好，甚至降低了分数，因此放弃了这种方法。所以在一开始构造好数据分布很重要。（比赛与项目会有些差异，真正项目其实还是更多覆盖数据分布越好，比赛可能只是华为公开的数据集包括测试的数据分布一样的，导致不能拿过多的外部数据（容易过拟合））
	
* 3、数据归一化
	
* 4、标签平滑
	 
* 5、mixup
	

* （2）发掘与训练模型的潜力：
	
* 1、使用多种模型进行对比实验
	
* 2、选择改进的Adam优化方法 ：Adam with warm up优化器
	
* 3、自定义学习率-余弦退火学习率

		
### 自带warmup的学习率控制对迭代次数比较稳健(只要达到足够的迭代次数，最终结果都比 较接近)，大大降低调参复杂性，缩短实验周期

